# 🧭 Chrome 137 更新チェック（Stable＋コードサンプル付き）

- リリース日: 2025-05-27（Stable）
- 一次情報:
  - [Release Notes](https://developer.chrome.com/release-notes/137?hl=ja)
  - [New in Chrome 137](https://developer.chrome.com/blog/new-in-chrome-137)
  - [New in DevTools 137](https://developer.chrome.com/blog/new-in-devtools-137)
  - [Chrome Releases: Stable Channel Update (May 27, 2025)](https://chromereleases.googleblog.com/2025/05/stable-channel-update-for-desktop_27.html)
  - [Chrome Releases: Stable Channel Update (June 2, 2025)](https://chromereleases.googleblog.com/2025/06/stable-channel-update-for-desktop.html)
  - [Chrome Releases: Stable Channel Update (June 17, 2025)](https://chromereleases.googleblog.com/2025/06/stable-channel-update-for-desktop_17.html)
  - [ChromeStatus Roadmap](https://chromestatus.com/roadmap)
  - [MDN](https://developer.mozilla.org/ja/docs/Web) / [Can I use](https://caniuse.com/)
  - [Baseline](https://web.dev/baseline?hl=ja)

---

## 🔹 全体サマリ
- **CSS `if()` 関数**（条件に応じた値分岐を簡潔に表現）
- **AI Writer / Rewriter API（Origin Trial）**（オンデバイスLLMで文章生成・リライト）
- **DevTools: Gemini 連携で CSS 修正をワークスペースへ保存**（実験）
- セキュリティ修正（137.0.7151.xx のマイナー更新を含む）

### 🚨 重要度の高いもの
- **CSS `if()`** によるテーマ・環境依存スタイルの簡潔化
- **Writer/Rewriter API**（OT）でアプリ内AI文案を構築可能（プライバシー配慮のオンデバイス）
- **DevTools×Gemini** で「ブラウザ内からCSSを提案→保存」の体験が現実的に

---

## 🧩 HTML
- 本版でのHTML仕様大きめ更新は無し（関連: `<dialog>` 強化は 134–135 を参照）。

---

## 🎨 CSS
### `if()` 関数
```css
/* テーマ変数に応じて背景色を条件分岐 */
:root { --theme: light; }
.card {
  background: if(style(--theme: dark): #111; else: #fff);
  color:       if(style(--theme: dark): #fff; else: #111);
}

/* メディア条件と組み合わせ（Chrome 137 では media()/supports()/style() ラッパーが必要） */
.card img {
  filter: if(media(prefers-color-scheme: dark): brightness(1.1); else: none);
}
```

---

## ⚙️ JavaScript (V8)
- 目立つ構文追加は無し（136の `RegExp.escape()` は別稿参照）。

---

## 🧠 AI in Chrome
### Writer / Rewriter API（Origin Trial）
```js
// 例: Rewriter API でトーンを丁寧寄りに（実験API・インターフェースは変更の可能性あり）
const text = 'このPR、直して';

// ファクトリで Rewriter を生成（tone/format/length/sharedContext を指定可能）
const rewriter = await ai.rewriter.create({
  tone: 'more-formal',     // 'more-formal' | 'as-is' | 'more-casual'
  format: 'as-is',         // 'as-is' | 'markdown' | 'plain-text'
  length: 'as-is',         // 'shorter' | 'as-is' | 'longer'
  sharedContext: { domain: 'code-review' }
});

const res = await rewriter.rewrite(text);
console.log(res.output); // こちらのPR、ご確認と修正のご検討をお願いします
```
> オンデバイスLLM（Gemini Nano相当）を利用。OT期間・制限は ChromeStatus を参照。

---

## 🧰 DevTools
### Gemini でCSSを提案し、ワークスペースへ保存（実験）
```text
- 有効化（例）:
  1) chrome://flags で関連フラグ（AI/Assist, Workspaces 自動検出 など版によって名称差）を有効化
  2) DevTools を開き F1(設定) → Experiments で AI assistance / Workspaces 関連の実験をオン
  3) Sources パネルの Workspaces で "Auto-detect" をオン
- 使い方: Elements または Styles から AI アシストで CSS を提案→適用。適用時はローカルへ保存（復元可能）。
```

**補足**: Elements の `A` キーによるフルページ・アクセシビリティツリー表示は **独立の改善点**（Gemini 連携とは別機能）。

---

## 🌐 Web API（その他）
- 目立つStable昇格は無し（Security/Origin Trial は上記参照）。

---

## 🧾 セキュリティ更新
- 137.0.7151.55/.56（2025-05-27）初回昇格。以降 137.0.7151.68（2025-06-02）、137.0.7151.119（2025-06-17）などで複数CVE修正。Chrome Releases参照。

---

### 導入指針メモ
- **CSS**: `if()` で `@media`/`@supports`/カスタムプロパティ判定を簡潔に
- **AI**: Rewriter/Writer は OTフラグ下での評価を継続。プロンプト/出力の監査ログ設計を
- **DevTools**: DevToolsのGemini統合機能では、ElementsやSourcesから直接CSS修正を提案・保存できるが、本番コードへの自動反映は避ける。チーム標準として次の運用指針を推奨。

  1. **提案段階と保存段階を分離**: 提案は即反映せず、レビュー対象として保持。開発者が再現性・意図整合性を確認する。
  2. **保存時のログ出力**: 提案内容・生成時の要素・時刻をJSONまたはGitフックで記録し、採用/却下理由をコメント化。
  3. **AI提案の適用範囲**: UI/スタイル調整中心。DOM構造変更やARIA属性追加はアクセシビリティ専門レビューを経る。
  4. **データ保護**: 社内コードをLLMに再送信せず、オンデバイスLLM利用を基本とし、入力/出力ログは暗号化。
  → 本機能はチームの「レビュー文化」と整合させることで、AI提案による効率化と品質維持を両立可能。
